<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <title>Main - PC</title>
        <link rel="stylesheet" href="../fonts/Modetour/Modetour.css"/>
        <link rel="stylesheet" href="../fonts/Pretendard-1.3.7/web/static/pretendard.css"/>
    </head>

    <style>
        .button-list {
            display: flex;
            gap: 0 20px;
        }
    </style>

    <body>

        <div class="button-list" id="event-container">
            <button onclick="showPopup('ponup contain', false)">CHECK LOGIN</button>

            <button onclick="getEventList()">GEN EVENT LIST</button>

            <button onclick="joinEvent()">JOIN EVENT</button>

            <button onclick="cancelJoinEvent()">CANCEL JOIN EVENT</button>


        </div>

        <div id="listEvent"></div>

        <!-- end modal-->
        <script>

            function showPopup(url, isCancel) {
                window.parent.showPopupFunction(url, isCancel)
            }

            async function getEventList() {
                const eventList = await parent.getEventListFunction().then((value) => {
                    return value
                });
                const listEvent = document.getElementById("listEvent");
                const showHTML = eventList ?. map((object, index) => {
                    return `<div> <p> stt :  ${index} </p>  <p> eventId : ${
                        object.eventId
                    }</p> <p> specialExhibitionId : ${
                        object.specialExhibitionId
                    }</p> </div>`
                })
                listEvent.innerHTML = showHTML
                console.log("eventList", eventList)
            }

            async function joinEvent() {
                const result = await window.parent.joinEventFunction().then((value) => {
                    return value
                });
                console.log("result join event = ", result);
            }

            async function cancelJoinEvent() {
                const result = await window.parent.cancelJoinEventFunction().then((value) => {
                    return value
                });
                console.log("result cancel join event = ", result)
            }

            // =======================================================================================
            const modal = document.querySelector("#event-modal");
            const modalBody = document.querySelector("#event-modal .modal-body");
            const modalButton = document.querySelector("#event-modal .modal-footer .btn-ok");
            let isLogin = false;
            function checkLogin(url) {
                if (! isLogin) {
                    modalBody.innerHTML = `회원만 참여 가능한 이벤트입니다. 로그인 하시겠습니까?`;

                    modalButton.addEventListener("click", function () {
                        isLogin = true;
                        window.location.href = url;
                    });
                    showAlert();
                } else {
                    window.location.href = url;
                }
            }
            function closeAlert() {
                modal.classList.remove("show");
            }
            function showAlert() {
                modal.classList.add("show");
            }
        </script>
    </body>
</html>
